const CONFIG={MOUSE_RANGE:400,MOUSE_FALLOFF:400,WEIGHT:{MIN:60,MAX:140,BASELINE:60},DISTORTION:{MIN:0,MAX:60,BASELINE:0},TILT_SENSITIVITY:60,DECAY:{CLICK:.95,KEYBOARD:.92,ORIENTATION:.98,TAP:.92},SPEED:{TYPING_RESET:1e3,TAP_RESET:1e3,DECAY_DELAY:500},FIXED_LETTERS:3,THROTTLE:{MOUSE:64,SCROLL:32,ORIENTATION:128},CACHE:{RECT_DURATION:100,MAX_CACHE_SIZE:50},PERFORMANCE:{TARGET_FPS:20,FRAME_TIME_THRESHOLD:50,ADAPTIVE_QUALITY:!0,FRAME_SKIP_THRESHOLD:.1,INACTIVITY_TIMEOUT:2e3},GLASS_GRID:{PANE_SIZE:70,GAP:0,REFRACTION_RADIUS:120,EMITTER_SIZE:140,MOBILE:{PANE_SIZE:60,GAP:0,REFRACTION_RADIUS:100,EMITTER_SIZE:120},SMALL_MOBILE:{PANE_SIZE:50,GAP:0,REFRACTION_RADIUS:80,EMITTER_SIZE:100}}};class PerformanceMonitor{constructor(){this.frameTimes=new Array(60).fill(0),this.frameIndex=0,this.lastFrameTime=0,this.qualityLevel=1,this.frameCount=0}startFrame(){this.lastFrameTime=performance.now()}endFrame(){const t=performance.now()-this.lastFrameTime;if(this.frameTimes[this.frameIndex]=t,this.frameIndex=(this.frameIndex+1)%60,this.frameCount=Math.min(this.frameCount+1,60),CONFIG.PERFORMANCE.ADAPTIVE_QUALITY&&this.frameCount>=30){const t=this.frameTimes.reduce((t,e)=>t+e,0)/this.frameCount;t>1.2*CONFIG.PERFORMANCE.FRAME_TIME_THRESHOLD?this.qualityLevel=Math.max(.3,.95*this.qualityLevel):t<.8*CONFIG.PERFORMANCE.FRAME_TIME_THRESHOLD&&(this.qualityLevel=Math.min(1,1.02*this.qualityLevel))}}getQualityLevel(){return this.qualityLevel}getAverageFrameTime(){return 0===this.frameCount?0:this.frameTimes.reduce((t,e)=>t+e,0)/this.frameCount}}class DOMCache{constructor(){this.cache=new Map,this.timestamps=new Map,this.rectPool=[],this.poolSize=20}getRect(t){const e=performance.now(),i=t;if(this.cache.has(i)){if(e-this.timestamps.get(i)<CONFIG.CACHE.RECT_DURATION)return this.cache.get(i)}const s=t.getBoundingClientRect();let n=this.rectPool.pop();return n||(n={}),n.left=s.left,n.top=s.top,n.width=s.width,n.height=s.height,n.centerX=s.left+s.width/2,n.centerY=s.top+s.height/2,this.cache.set(i,n),this.timestamps.set(i,e),this.cleanup(),n}cleanup(){if(this.cache.size>CONFIG.CACHE.MAX_CACHE_SIZE){const t=performance.now(),e=[];for(const[i,s]of this.timestamps)t-s>2*CONFIG.CACHE.RECT_DURATION&&e.push(i);e.forEach(t=>{const e=this.cache.get(t);e&&this.rectPool.length<this.poolSize&&this.rectPool.push(e),this.cache.delete(t),this.timestamps.delete(t)})}}clear(){for(const t of this.cache.values())this.rectPool.length<this.poolSize&&this.rectPool.push(t);this.cache.clear(),this.timestamps.clear()}}class Throttler{constructor(t){this.delay=t,this.lastCall=0,this.pendingCall=null}throttle(t){return(...e)=>{const i=performance.now();i-this.lastCall>=this.delay?(this.lastCall=i,t(...e)):(this.pendingCall&&clearTimeout(this.pendingCall),this.pendingCall=setTimeout(()=>{this.lastCall=performance.now(),t(...e)},this.delay-(i-this.lastCall)))}}}class ModalManager{constructor(){this.modal=document.getElementById("contactModal"),this.floatingBtn=document.getElementById("floatingInfoBtn"),this.isOpen=!1,this.lastScrollY=0,this.scrollThreshold=50,this.scrollTimeout=null,this.scrollStartTime=0,this.scrollStartY=0,this.initialize()}initialize(){this.floatingBtn&&this.floatingBtn.addEventListener("click",()=>{this.isOpen?this.closeModal():this.openModal()}),this.modal&&(this.modal.addEventListener("click",t=>{t.target===this.modal&&this.closeModal()}),document.addEventListener("keydown",t=>{"Escape"===t.key&&this.isOpen&&this.closeModal()})),this.lastScrollY=window.scrollY,this.setupScrollDetection()}setupScrollDetection(){let t=!1;const e=()=>{if(!this.isOpen)return;const e=window.scrollY;if(this.lastScrollY-e>0){this.scrollTimeout&&clearTimeout(this.scrollTimeout),t||(this.scrollStartY=e,this.scrollStartTime=Date.now(),t=!0);const i=this.scrollStartY-e,s=Date.now()-this.scrollStartTime;i>=this.scrollThreshold||s>=500?(this.closeModal(),t=!1):this.scrollTimeout=setTimeout(()=>{this.isOpen&&i>=this.scrollThreshold/2&&this.closeModal(),t=!1},300)}else t=!1,this.scrollTimeout&&(clearTimeout(this.scrollTimeout),this.scrollTimeout=null);this.lastScrollY=e};let i=!1;window.addEventListener("scroll",()=>{i||(requestAnimationFrame(()=>{e(),i=!1}),i=!0)},{passive:!0})}openModal(){this.modal&&!this.isOpen&&(this.isOpen=!0,this.modal.classList.add("active"),this.floatingBtn.classList.add("modal-active"),this.lastScrollY=window.scrollY,this.scrollStartY=window.scrollY,this.scrollStartTime=Date.now(),document.body.style.overflow="hidden",this.floatingBtn.style.transform="scale(0.95)",setTimeout(()=>{this.floatingBtn.style.transform=""},150))}closeModal(){this.modal&&this.isOpen&&(this.isOpen=!1,this.modal.classList.remove("active"),this.floatingBtn.classList.remove("modal-active"),this.scrollTimeout&&(clearTimeout(this.scrollTimeout),this.scrollTimeout=null),document.body.style.overflow="",this.floatingBtn.style.transform="scale(0.95)",setTimeout(()=>{this.floatingBtn.style.transform=""},150))}destroy(){document.body.style.overflow="",this.scrollTimeout&&clearTimeout(this.scrollTimeout)}}class InteractiveState{constructor(){this.mouseActive=!1,this.lastMouseX=0,this.lastMouseY=0,this.mouseVelocity=0,this.clickEffect=0,this.keyboardEffect=0,this.lastKeyTime=0,this.keyCount=0,this.typingSpeed=0,this.maxTypingSpeed=0,this.deviceOrientation={alpha:0,beta:0,gamma:0},this.orientationEffect=0,this.verticalTilt=0,this.horizontalTilt=0,this.tapEffect=0,this.lastTapTime=0,this.tapCount=0,this.tapSpeed=0}updateDecay(){this.clickEffect*=CONFIG.DECAY.CLICK,this.keyboardEffect*=CONFIG.DECAY.KEYBOARD,this.orientationEffect*=CONFIG.DECAY.ORIENTATION,this.tapEffect*=CONFIG.DECAY.TAP,Date.now()-this.lastKeyTime>CONFIG.SPEED.TYPING_RESET&&(this.typingSpeed*=.98,this.keyCount=Math.max(0,this.keyCount-.1)),Date.now()-this.lastTapTime>CONFIG.SPEED.TAP_RESET&&(this.tapSpeed*=.98,this.tapCount=Math.max(0,this.tapCount-.1))}}class EffectCalculator{static calculateMouseEffects(t,e,i,s,n,o,a=1){const r=t-i.centerX,l=e-i.centerY,h=r*r+l*l;if(h>=CONFIG.MOUSE_RANGE*CONFIG.MOUSE_RANGE)return{weight:0,distortion:0};const c=Math.sqrt(h),d=Math.max(0,1-c/CONFIG.MOUSE_FALLOFF);if(d<CONFIG.PERFORMANCE.FRAME_SKIP_THRESHOLD)return{weight:0,distortion:0};const m=Math.max(.5,a),u=n+.5*s,p=3*n+.3*s,E=a>.7?2:1,f=15*Math.sin(u*E)*d*m,T=8*Math.sin(p)*d*m,I=Math.min(20,.1*o.mouseVelocity)*d,g=a>.5?Math.sin(8*n+.8*s)*I*m:0,y=c/8,M=Math.max(0,CONFIG.DISTORTION.MAX-y)*d,S=Math.max(CONFIG.WEIGHT.MIN,CONFIG.WEIGHT.MAX-c/15)*d;return{weight:Math.max(CONFIG.WEIGHT.MIN,Math.min(CONFIG.WEIGHT.MAX,S+T+I)),distortion:Math.max(0,Math.min(CONFIG.DISTORTION.MAX,M+f+g))}}static calculateBaselineEffects(t,e,i,s=1){if(i.clickEffect+i.keyboardEffect+i.tapEffect+Math.abs(i.verticalTilt)+Math.abs(i.horizontalTilt)<CONFIG.PERFORMANCE.FRAME_SKIP_THRESHOLD)return{weight:CONFIG.WEIGHT.BASELINE,distortion:CONFIG.DISTORTION.BASELINE};const n=CONFIG.WEIGHT.BASELINE,o=CONFIG.DISTORTION.BASELINE,a=Math.max(.5,s),r=e+.4*t,l=6*e+.6*t,h=15*Math.sin(12*e+r)*i.clickEffect*a,c=10*Math.sin(l)*i.clickEffect*a,d=Math.min(2,i.typingSpeed/3),m=25*Math.sin(e*(20+10*d)+.3*t)*i.keyboardEffect*a,u=15*Math.sin(e*(8+5*d)+.7*t)*i.keyboardEffect*a,p=s>.6?10*Math.sin(30*e+.9*t)*i.keyboardEffect*d*a:0,E=s>.6?8*Math.cos(25*e+.2*t)*i.keyboardEffect*d*a:0,f=Math.min(2,i.tapSpeed/3),T=20*Math.sin(e*(18+8*f)+.4*t)*i.tapEffect*a,I=12*Math.sin(e*(6+4*f)+.8*t)*i.tapEffect*a,g=s>.6?8*Math.sin(28*e+.7*t)*i.tapEffect*f*a:0,y=s>.6?6*Math.cos(22*e+.3*t)*i.tapEffect*f*a:0,M=Math.min(CONFIG.DISTORTION.MAX,60*i.verticalTilt);return{weight:n+c+u+I+Math.min(CONFIG.WEIGHT.MAX-CONFIG.WEIGHT.BASELINE,80*i.horizontalTilt),distortion:o+h+m+p+E+T+g+y+M}}}class MobileSensorManager{constructor(t){this.state=t,this.isInitialized=!1,this.permissionButton=null,this.orientationThrottler=new Throttler(CONFIG.THROTTLE.ORIENTATION)}async initialize(){if(!this.isInitialized)try{if(!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))return void(this.isInitialized=!0);if("undefined"!=typeof DeviceOrientationEvent&&"function"==typeof DeviceOrientationEvent.requestPermission){this.checkStoredPermission()?this.setupOrientationListener():this.showPermissionButton()}else this.setupOrientationListener();this.isInitialized=!0}catch(t){console.error("Mobile sensor initialization failed:",t)}}checkStoredPermission(){try{return"true"===localStorage.getItem("motionEffectsEnabled")}catch(t){return!1}}storePermission(t){try{localStorage.setItem("motionEffectsEnabled",t.toString())}catch(t){console.warn("Could not store permission preference:",t)}}clearStoredPermission(){try{localStorage.removeItem("motionEffectsEnabled")}catch(t){console.warn("Could not clear permission preference:",t)}}showPermissionButton(){if(this.permissionContainer)return;this.permissionContainer=document.createElement("div"),this.permissionContainer.className="permission-container",this.permissionButton=document.createElement("button"),this.permissionButton.textContent="Enable Motion-Sensitive Logo",this.permissionButton.className="permission-button",this.permissionButton.addEventListener("click",async()=>{try{"granted"===await DeviceOrientationEvent.requestPermission()?(this.setupOrientationListener(),this.hidePermissionButton(),this.storePermission(!0)):this.storePermission(!1)}catch(t){console.error("Permission request failed:",t),this.storePermission(!1)}}),this.dismissButton=document.createElement("button"),this.dismissButton.innerHTML="&times;",this.dismissButton.className="dismiss-button",this.dismissButton.setAttribute("aria-label","Dismiss"),this.dismissButton.addEventListener("click",()=>{this.hidePermissionButton(),this.storePermission(!1)}),this.permissionContainer.appendChild(this.permissionButton),this.permissionContainer.appendChild(this.dismissButton);const t=document.querySelector(".hero");if(t){const e=document.querySelector(".subtitle");if(e)e.parentNode.insertBefore(this.permissionContainer,e.nextSibling);else{const e=document.querySelector("#splash");e?e.parentNode.insertBefore(this.permissionContainer,e.nextSibling):t.appendChild(this.permissionContainer)}}else{const t=document.querySelector(".subtitle");t&&t.parentNode?t.parentNode.insertBefore(this.permissionContainer,t.nextSibling):document.body.appendChild(this.permissionContainer)}}hidePermissionButton(){this.permissionContainer&&this.permissionContainer.parentNode&&(this.permissionContainer.parentNode.removeChild(this.permissionContainer),this.permissionContainer=null,this.permissionButton=null,this.dismissButton=null)}setupOrientationListener(){const t=this.orientationThrottler.throttle(t=>{const e=null!==t.alpha&&void 0!==t.alpha?t.alpha:0,i=null!==t.beta&&void 0!==t.beta?t.beta:0,s=null!==t.gamma&&void 0!==t.gamma?t.gamma:0,n=i>=0&&i<=180?i:90,o=s>=-180&&s<=180?s:0;this.state.deviceOrientation.alpha=e,this.state.deviceOrientation.beta=n,this.state.deviceOrientation.gamma=o,this.state.verticalTilt=Math.min(1,Math.abs(this.state.deviceOrientation.beta-90)/CONFIG.TILT_SENSITIVITY),this.state.horizontalTilt=Math.min(1,Math.abs(this.state.deviceOrientation.gamma)/CONFIG.TILT_SENSITIVITY),this.state.orientationEffect=Math.min(1,(this.state.verticalTilt+this.state.horizontalTilt)/2)});window.addEventListener("deviceorientation",t)}}class GlassGridManager{constructor(){this.gridContainer=document.getElementById("glassPaneGrid"),this.panes=[],this.mouseX=0,this.mouseY=0,this.isInitialized=!1,this.isMoving=!1,this.movementThreshold=5,this.lastMouseX=0,this.lastMouseY=0}initialize(){this.gridContainer?(null!==this.gridContainer.offsetParent&&this.createGlassPanes(),this.isInitialized=!0):console.warn("Glass grid container not found")}createGlassPanes(){const t=this.gridContainer.getBoundingClientRect(),e=this.getResponsiveSettings(),i=e.PANE_SIZE,s=e.GAP,n=Math.ceil(t.width/(i+s)),o=Math.ceil(t.height/(i+s));this.gridContainer.innerHTML="",this.panes=[];for(let t=0;t<o;t++)for(let t=0;t<n;t++){const t=document.createElement("div");t.className="glass-pane",t.style.width=`${i}px`,t.style.height=`${i}px`;const e=.85+.15*Math.random();t.style.opacity=e,this.gridContainer.appendChild(t),this.panes.push(t)}}getResponsiveSettings(){const t=window.innerWidth;return t<=480?CONFIG.GLASS_GRID.SMALL_MOBILE:t<=768?CONFIG.GLASS_GRID.MOBILE:{PANE_SIZE:CONFIG.GLASS_GRID.PANE_SIZE,GAP:CONFIG.GLASS_GRID.GAP,REFRACTION_RADIUS:CONFIG.GLASS_GRID.REFRACTION_RADIUS,EMITTER_SIZE:CONFIG.GLASS_GRID.EMITTER_SIZE}}setupMouseTracking(){let t;const e=e=>{this.mouseX=e.clientX,this.mouseY=e.clientY;const i=Math.sqrt(Math.pow(this.mouseX-this.lastMouseX,2)+Math.pow(this.mouseY-this.lastMouseY,2));this.isMoving=i>this.movementThreshold;const s=this.getResponsiveSettings();this.gradientEmitter.style.left=this.mouseX-s.EMITTER_SIZE/2+"px",this.gradientEmitter.style.top=this.mouseY-s.EMITTER_SIZE/2+"px",this.updateCirclePositions(),this.updateRefractionEffects(),this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY,t&&cancelAnimationFrame(t),t=requestAnimationFrame(()=>{this.updateRefractionEffects()})};let i=0;document.addEventListener("mousemove",t=>{const s=performance.now();s-i>=CONFIG.THROTTLE.MOUSE&&(i=s,e(t))}),window.addEventListener("resize",()=>{setTimeout(()=>{this.createGlassPanes()},100)})}updateCirclePositions(){const t=this.getResponsiveSettings().EMITTER_SIZE;this.isMoving?(this.circlePositions[0]={x:this.mouseX,y:this.mouseY},this.circlePositions[1].x+=.3*(this.circlePositions[0].x-this.circlePositions[1].x),this.circlePositions[1].y+=.3*(this.circlePositions[0].y-this.circlePositions[1].y),this.circlePositions[2].x+=.25*(this.circlePositions[1].x-this.circlePositions[2].x),this.circlePositions[2].y+=.25*(this.circlePositions[1].y-this.circlePositions[2].y),this.circlePositions[3].x+=.2*(this.circlePositions[2].x-this.circlePositions[3].x),this.circlePositions[3].y+=.2*(this.circlePositions[2].y-this.circlePositions[3].y)):(this.circlePositions[0]={x:this.mouseX,y:this.mouseY},this.circlePositions[1]={x:this.mouseX,y:this.mouseY},this.circlePositions[2]={x:this.mouseX,y:this.mouseY},this.circlePositions[3]={x:this.mouseX,y:this.mouseY});this.circleCluster.querySelectorAll(".circle").forEach((e,i)=>{const s=this.circlePositions[i+1];e.style.left=s.x-t/2+"px",e.style.top=s.y-t/2+"px"})}updateRefractionEffects(){const t=this.getResponsiveSettings().REFRACTION_RADIUS;this.panes.forEach((e,i)=>{const s=e.getBoundingClientRect(),n=s.left+s.width/2,o=s.top+s.height/2,a=Math.sqrt(Math.pow(this.mouseX-n,2)+Math.pow(this.mouseY-o,2));if(a<t){const i=1-a/t,r=Math.pow(i,1.5),l=(this.mouseX-s.left)/s.width*100,h=(this.mouseY-s.top)/s.height*100,c=Math.sqrt(Math.pow(l-50,2)+Math.pow(h-50,2))/50;e.classList.add("refracting"),e.style.setProperty("--refraction-intensity",r),e.style.setProperty("--mouse-x",`${l}%`),e.style.setProperty("--mouse-y",`${h}%`),e.style.setProperty("--warp-intensity",c);const d=(this.mouseX-n)/t*3,m=`perspective(800px) rotateX(${(this.mouseY-o)/t*3}deg) rotateY(${d}deg) scale(${1+.03*r})`;e.style.transform=m}else e.classList.remove("refracting"),e.style.removeProperty("--refraction-intensity"),e.style.removeProperty("--mouse-x"),e.style.removeProperty("--mouse-y"),e.style.removeProperty("--warp-intensity"),e.style.transform=""})}destroy(){this.panes=[],this.isInitialized=!1}}class InteractiveTextApp{constructor(){this.letters=document.querySelectorAll("#splash span"),this.state=new InteractiveState,this.mobileSensors=new MobileSensorManager(this.state),this.performanceMonitor=new PerformanceMonitor,this.domCache=new DOMCache,this.mouseThrottler=new Throttler(CONFIG.THROTTLE.MOUSE),this.scrollThrottler=new Throttler(CONFIG.THROTTLE.SCROLL),this.modalManager=new ModalManager,this.glassGridManager=new GlassGridManager,this.animationId=null,this.isVisible=!0,this.isActive=!0,this.lastActivityTime=Date.now(),this.frameSkipCounter=0,this.targetFrameRate=this.detectOptimalFrameRate(),this.letterData=this.precalculateLetterData(),this.initialize()}detectOptimalFrameRate(){const t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),e=navigator.hardwareConcurrency&&navigator.hardwareConcurrency<=4;return t||e?15:20}precalculateLetterData(){const t=[];for(let e=0;e<this.letters.length;e++)t.push({element:this.letters[e],index:e,isFixed:e>=this.letters.length-CONFIG.FIXED_LETTERS,lastWeight:null,lastDistortion:null,lastColor:null});return t}initialize(){CSS.supports("backdrop-filter","blur(10px)")||document.body.classList.add("no-backdrop-filter"),this.testFontVariations(),this.setupEventListeners(),this.setupMobileSensors(),this.startAnimation(),setTimeout(()=>{this.checkScrollReveal()},100)}testFontVariations(){const t=document.createElement("span");t.style.fontFamily="Distort, sans-serif",t.style.fontSize="1px",t.style.position="absolute",t.style.visibility="hidden",t.textContent="A",document.body.appendChild(t);CSS.supports("font-variation-settings",'"wght" 100'),/Chrome/.test(navigator.userAgent)&&/Edge/.test(navigator.userAgent);t.style.fontVariationSettings='"wght" 100, "DIST" 30';getComputedStyle(t).fontVariationSettings;document.body.removeChild(t)}setupEventListeners(){const t=this.mouseThrottler.throttle(this.handleMouseMove.bind(this));document.addEventListener("mousemove",t),document.addEventListener("click",()=>{this.state.clickEffect=1,this.updateActivity()}),document.addEventListener("keydown",this.handleKeyDown.bind(this)),document.addEventListener("touchstart",this.handleTouchStart.bind(this));const e=this.scrollThrottler.throttle(this.handleScroll.bind(this));document.addEventListener("scroll",e),document.addEventListener("visibilitychange",this.handleVisibilityChange.bind(this)),window.addEventListener("focus",this.handleWindowFocus.bind(this)),window.addEventListener("blur",this.handleWindowBlur.bind(this)),this.checkScrollReveal()}handleVisibilityChange(){this.isVisible=!document.hidden,this.updateActivity()}handleWindowFocus(){this.isActive=!0,this.updateActivity()}handleWindowBlur(){this.isActive=!1}updateActivity(){this.lastActivityTime=Date.now()}setupMobileSensors(){this.mobileSensors.initialize()}handleMouseMove(t){const e=.001*Date.now(),i=t.clientX-this.state.lastMouseX,s=t.clientY-this.state.lastMouseY;this.state.mouseVelocity=Math.sqrt(i*i+s*s),this.state.lastMouseX=t.clientX,this.state.lastMouseY=t.clientY,this.updateActivity();let n=!1;const o=this.performanceMonitor.getQualityLevel(),a=t.clientX,r=t.clientY;this.letterData.forEach(t=>{if(t.isFixed)return void this.updateFixedLetter(t);const i=this.domCache.getRect(t.element),s=EffectCalculator.calculateMouseEffects(a,r,i,t.index,e,this.state,o);(s.weight>0||s.distortion>0)&&(n=!0,this.updateLetterStyles(t,s.weight,s.distortion))}),this.state.mouseActive=n}handleKeyDown(t){const e=Date.now(),i=e-this.state.lastKeyTime;i<CONFIG.SPEED.TYPING_RESET?(this.state.keyCount++,this.state.typingSpeed=this.state.keyCount/(i/1e3),this.state.maxTypingSpeed=Math.max(this.state.maxTypingSpeed,this.state.typingSpeed)):(this.state.keyCount=1,this.state.typingSpeed=1),this.state.lastKeyTime=e;const s=Math.min(3,this.state.typingSpeed/2);this.state.keyboardEffect=1*s}handleTouchStart(t){const e=Date.now(),i=e-this.state.lastTapTime;i<CONFIG.SPEED.TAP_RESET?(this.state.tapCount++,this.state.tapSpeed=this.state.tapCount/(i/1e3)):(this.state.tapCount=1,this.state.tapSpeed=1),this.state.lastTapTime=e;const s=Math.min(3,this.state.tapSpeed/2);this.state.tapEffect=1*s}handleScroll(){this.checkScrollReveal()}checkScrollReveal(){this.descriptions||(this.descriptions=document.querySelectorAll(".description"));const t=.8*window.innerHeight;this.descriptions.forEach((e,i)=>{if(e.classList.contains("revealed"))return;const s=this.domCache.getRect(e),n=s.top,o=s.height;n<t&&n+o>0&&e.classList.add("revealed")})}updateFixedLetter(t){const e=CONFIG.WEIGHT.BASELINE,i=CONFIG.DISTORTION.BASELINE;this.updateLetterStyles(t,e,i,"#FFFFFF")}updateLetterStyles(t,e,i,s=null){const n=CSS.supports("font-variation-settings",'"wght" 100'),o=/Chrome/.test(navigator.userAgent)&&!/Edge/.test(navigator.userAgent);if(t.lastWeight!==e||t.lastDistortion!==i){if(n){const s=`"wght" ${e.toFixed(1)}, "DIST" ${i.toFixed(1)}`;t.element.style.fontVariationSettings=s,o&&(t.element.style.fontWeight=e.toFixed(1),t.element.style.setProperty("font-variation-settings",s))}else{t.element.style.fontWeight=Math.round(e);const s=1+i/100;t.element.style.transform=`scaleX(${s})`}t.lastWeight=e,t.lastDistortion=i}s&&t.lastColor!==s&&(t.element.style.color=s,t.lastColor=s)}updateLetters(t){const e=this.performanceMonitor.getQualityLevel(),i=this.state.clickEffect>.01||this.state.keyboardEffect>.01||this.state.tapEffect>.01||Math.abs(this.state.verticalTilt)>.01||Math.abs(this.state.horizontalTilt)>.01;this.letterData.forEach(s=>{if(s.isFixed)return void this.updateFixedLetter(s);let n=CONFIG.WEIGHT.BASELINE,o=CONFIG.DISTORTION.BASELINE;if(i){const i=EffectCalculator.calculateBaselineEffects(s.index,t,this.state,e);n=i.weight,o=i.distortion,n=Math.max(CONFIG.WEIGHT.MIN,Math.min(CONFIG.WEIGHT.MAX,n)),o=Math.max(0,Math.min(CONFIG.DISTORTION.MAX,o))}if(this.state.mouseActive){const i=this.domCache.getRect(s.element),a=EffectCalculator.calculateMouseEffects(this.state.lastMouseX,this.state.lastMouseY,i,s.index,t,this.state,e);n=Math.max(CONFIG.WEIGHT.MIN,Math.min(CONFIG.WEIGHT.MAX,n+a.weight)),o=Math.max(0,Math.min(CONFIG.DISTORTION.MAX,o+a.distortion))}this.updateLetterStyles(s,n,o)})}startAnimation(){const t=e=>{if(this.performanceMonitor.startFrame(),!this.shouldAnimate())return void(this.animationId=requestAnimationFrame(t));const i=.001*e;if(this.state.updateDecay(),this.updateLetters(i),this.performanceMonitor.endFrame(),this.performanceMonitor.frameCount%60==0){const t=this.performanceMonitor.getAverageFrameTime(),e=this.performanceMonitor.getQualityLevel();console.log(`Performance: ${t.toFixed(1)}ms/frame, Quality: ${(100*e).toFixed(0)}%`)}const s=this.performanceMonitor.getAverageFrameTime(),n=1e3/this.targetFrameRate;s>1.5*n?setTimeout(()=>{this.animationId=requestAnimationFrame(t)},Math.max(0,n-s)):this.animationId=requestAnimationFrame(t)};this.animationId=requestAnimationFrame(t)}shouldAnimate(){if(!this.isVisible)return!1;if(!this.isActive)return!1;if(Date.now()-this.lastActivityTime>CONFIG.PERFORMANCE.INACTIVITY_TIMEOUT){if(this.frameSkipCounter++,this.frameSkipCounter<10)return!1;this.frameSkipCounter=0}else this.frameSkipCounter=0;return!0}destroy(){this.animationId&&cancelAnimationFrame(this.animationId),this.scrollThrottler.pendingCall&&clearTimeout(this.scrollThrottler.pendingCall),this.mouseThrottler.pendingCall&&clearTimeout(this.mouseThrottler.pendingCall),this.domCache.clear(),this.modalManager.destroy(),this.glassGridManager.destroy()}}async function handleFormSubmit(t){t.preventDefault();const e=t.target,i=e.querySelector('button[type="submit"]'),s=i.innerHTML;i.innerHTML="Sending...",i.disabled=!0;try{const t=new FormData(e),i={};for(let[e,s]of t.entries())"_redirect"!==e&&(i[e]?Array.isArray(i[e])?i[e].push(s):i[e]=[i[e],s]:i[e]=s);i._redirect=!1;const s=await fetch(e.action,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(i)});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);try{await s.json();showSuccessMessage(e,"Thank you! Your message has been sent successfully.")}catch(t){showSuccessMessage(e,"Thank you! Your message has been sent successfully.")}}catch(t){if(t.message.includes("Failed to fetch")||t.message.includes("NetworkError")){const t=e.querySelector('input[name="_redirect"]');t&&t.remove(),showSuccessMessage(e,"Thank you! Your message has been sent successfully."),setTimeout(()=>{e.submit()},1e3)}else showErrorMessage(e,"Sorry, there was an error sending your message. Please try again or contact us directly at brandon@quietloudlab.com")}finally{i.innerHTML=s,i.disabled=!1}}function showSuccessMessage(t,e){t.parentNode.querySelectorAll(".form-message").forEach(t=>t.remove());const i=document.createElement("div");i.className="form-message success",i.innerHTML=`\n    <div style="\n      background: rgba(76, 175, 80, 0.1); \n      border: 1px solid rgba(76, 175, 80, 0.3); \n      padding: 1.5rem; \n      border-radius: 12px; \n      margin: 1.5rem 0; \n      color: #4CAF50;\n      font-size: 1rem;\n      line-height: 1.5;\n      backdrop-filter: blur(10px);\n      box-shadow: 0 4px 20px rgba(76, 175, 80, 0.1);\n    ">\n      <div style="display: flex; align-items: center; gap: 0.5rem;">\n        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>\n          <polyline points="22,4 12,14.01 9,11.01"></polyline>\n        </svg>\n        <strong>Success!</strong>\n      </div>\n      <div style="margin-top: 0.5rem;">${e}</div>\n    </div>\n  `,t.parentNode.insertBefore(i,t.nextSibling),t.reset(),i.scrollIntoView({behavior:"smooth",block:"nearest"}),setTimeout(()=>{i.parentNode&&(i.style.opacity="0",i.style.transform="translateY(-10px)",i.style.transition="all 0.3s ease",setTimeout(()=>i.remove(),300))},8e3)}function showErrorMessage(t,e){t.parentNode.querySelectorAll(".form-message").forEach(t=>t.remove());const i=document.createElement("div");i.className="form-message error",i.innerHTML=`\n    <div style="\n      background: rgba(244, 67, 54, 0.1); \n      border: 1px solid rgba(244, 67, 54, 0.3); \n      padding: 1.5rem; \n      border-radius: 12px; \n      margin: 1.5rem 0; \n      color: #F44336;\n      font-size: 1rem;\n      line-height: 1.5;\n      backdrop-filter: blur(10px);\n      box-shadow: 0 4px 20px rgba(244, 67, 54, 0.1);\n    ">\n      <div style="display: flex; align-items: center; gap: 0.5rem;">\n        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n          <circle cx="12" cy="12" r="10"></circle>\n          <line x1="15" y1="9" x2="9" y2="15"></line>\n          <line x1="9" y1="9" x2="15" y2="15"></line>\n        </svg>\n        <strong>Error:</strong>\n      </div>\n      <div style="margin-top: 0.5rem;">${e}</div>\n    </div>\n  `,t.parentNode.insertBefore(i,t.nextSibling),i.scrollIntoView({behavior:"smooth",block:"nearest"}),setTimeout(()=>{i.parentNode&&(i.style.opacity="0",i.style.transform="translateY(-10px)",i.style.transition="all 0.3s ease",setTimeout(()=>i.remove(),300))},1e4)}document.addEventListener("DOMContentLoaded",function(){const t=document.querySelector(".signup-form");t&&t.addEventListener("submit",handleFormSubmit);const e=document.querySelector(".contact-form-inner");e&&e.addEventListener("submit",handleFormSubmit)});const app=new InteractiveTextApp;window.addEventListener("beforeunload",()=>{app.destroy()});